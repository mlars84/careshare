myApp.service("careShareService",["$http","$location",function(a,b){const c=this;c.users={list:[]},c.profiles={names:[]},c.careShares={shares:[]},c.checkUserSession=function(){a.get("/user").then(function(a){a.data.username?(c.userName=a.data.username,c.userId=a.data._id,console.log("User Data: ",c.userName,c.userId)):b.path("/home")})},c.checkUserSession(),c.getUsers=function(){c.checkUserSession(),console.log("getting all other users list"),a({method:"GET",url:"/careshare/getUsers"}).then(function(a){console.log(a.data),c.users.list=[],console.log(c.users.list);for(var b=0;b<a.data.length;b++)console.log(a.data[b].username,c.userName),a.data[b].username!==c.userName&&(c.users.list.push(a.data[b]),console.log())})},c.getProfilesToShare=function(){console.log("in getProfilesToShare"),a({method:"GET",url:"/careshare/getProfilesToShare"}).then(function(a){console.log("res.data =>",a.data),c.profiles.names=[],c.getCareShares(a.data);for(var b=0;b<a.data.length;b++)console.log(a.data[b].userCreated),a.data[b].userCreated===c.userId&&c.profiles.names.push(a.data[b])})},c.getProfilesToShare(),c.returnToProfile=function(){console.log("back to profile button clicked!"),b.path("/profile"),c.clearUsers()},c.clearUsers=function(){c.users.list=[]},c.shareProfile=function(b,c){console.log("share button clicked!"),console.log("user =>",b,"profile =>",c);const d={userToShareWith:b,careProfileToShare:c};console.log(d),a({method:"PUT",url:"/careshare/shareProfile",data:d}).then(function(a){console.log(a.data),swal(c.name+" has been shared with "+b.username+"!")})},c.getCareShares=function(a){console.log("in getCareShares function"),console.log(a),c.careShares.shares=[];for(var b=0;b<a.length;b++){console.log("allProfiles[i] =>",a[b]);for(var d=a[b].sharedWith,e=0;e<d.length;e++)console.log("sharedWithArray[j] =>",d[e]),d[e].userId==c.userId?(console.log(d[e].userId),c.careShares.shares.push(a[b]),console.log("vm.careShares.shares =>",c.careShares.shares)):console.log("NO MATCH!")}}}]);